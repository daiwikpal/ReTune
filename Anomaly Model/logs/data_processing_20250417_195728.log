2025-04-17 19:57:28,979 - __main__ - INFO - Logging configured. Log file: /Users/daiwikpal/VSCode/ReTune/Anomaly Model/logs/data_processing_20250417_195728.log
2025-04-17 19:57:28,979 - __main__ - INFO - Starting weather data processing
2025-04-17 19:57:28,979 - __main__ - INFO - Parameters: include_precipitation=True, use_synthetic_if_api_fails=True
2025-04-17 19:57:28,979 - __main__ - INFO - Found 29 CSV files in Anomaly Model/Historical Data/*.csv
2025-04-17 19:57:28,980 - __main__ - INFO - Processing file 1/29: StormEvents_details-ftp_v1.0_d1996_c20250401.csv
2025-04-17 19:57:29,316 - __main__ - INFO -   Read 48534 rows from StormEvents_details-ftp_v1.0_d1996_c20250401.csv
2025-04-17 19:57:29,360 - __main__ - INFO - Processing file 2/29: StormEvents_details-ftp_v1.0_d1997_c20250401.csv
2025-04-17 19:57:29,690 - __main__ - INFO -   Read 41991 rows from StormEvents_details-ftp_v1.0_d1997_c20250401.csv
2025-04-17 19:57:29,716 - __main__ - INFO - Processing file 3/29: StormEvents_details-ftp_v1.0_d1998_c20250401.csv
2025-04-17 19:57:30,139 - __main__ - INFO -   Read 50973 rows from StormEvents_details-ftp_v1.0_d1998_c20250401.csv
2025-04-17 19:57:30,171 - __main__ - INFO - Processing file 4/29: StormEvents_details-ftp_v1.0_d1999_c20250401.csv
2025-04-17 19:57:30,584 - __main__ - INFO -   Read 46383 rows from StormEvents_details-ftp_v1.0_d1999_c20250401.csv
2025-04-17 19:57:30,613 - __main__ - INFO - Processing file 5/29: StormEvents_details-ftp_v1.0_d2000_c20250401.csv
2025-04-17 19:57:31,001 - __main__ - INFO -   Read 52007 rows from StormEvents_details-ftp_v1.0_d2000_c20250401.csv
2025-04-17 19:57:31,033 - __main__ - INFO - Processing file 6/29: StormEvents_details-ftp_v1.0_d2001_c20250401.csv
2025-04-17 19:57:31,382 - __main__ - INFO -   Read 48875 rows from StormEvents_details-ftp_v1.0_d2001_c20250401.csv
2025-04-17 19:57:31,407 - __main__ - INFO - Processing file 7/29: StormEvents_details-ftp_v1.0_d2002_c20250401.csv
2025-04-17 19:57:31,775 - __main__ - INFO -   Read 50936 rows from StormEvents_details-ftp_v1.0_d2002_c20250401.csv
2025-04-17 19:57:31,807 - __main__ - INFO - Processing file 8/29: StormEvents_details-ftp_v1.0_d2003_c20250401.csv
2025-04-17 19:57:32,176 - __main__ - INFO -   Read 52956 rows from StormEvents_details-ftp_v1.0_d2003_c20250401.csv
2025-04-17 19:57:32,205 - __main__ - INFO - Processing file 9/29: StormEvents_details-ftp_v1.0_d2004_c20250401.csv
2025-04-17 19:57:32,627 - __main__ - INFO -   Read 52409 rows from StormEvents_details-ftp_v1.0_d2004_c20250401.csv
2025-04-17 19:57:32,659 - __main__ - INFO - Processing file 10/29: StormEvents_details-ftp_v1.0_d2005_c20250401.csv
2025-04-17 19:57:33,073 - __main__ - INFO -   Read 53976 rows from StormEvents_details-ftp_v1.0_d2005_c20250401.csv
2025-04-17 19:57:33,105 - __main__ - INFO - Processing file 11/29: StormEvents_details-ftp_v1.0_d2006_c20250401.csv
2025-04-17 19:57:33,528 - __main__ - INFO -   Read 56400 rows from StormEvents_details-ftp_v1.0_d2006_c20250401.csv
2025-04-17 19:57:33,563 - __main__ - INFO - Processing file 12/29: StormEvents_details-ftp_v1.0_d2007_c20250401.csv
2025-04-17 19:57:34,210 - __main__ - INFO -   Read 59011 rows from StormEvents_details-ftp_v1.0_d2007_c20250401.csv
2025-04-17 19:57:34,255 - __main__ - INFO - Processing file 13/29: StormEvents_details-ftp_v1.0_d2008_c20250401.csv
2025-04-17 19:57:35,300 - __main__ - INFO -   Read 71190 rows from StormEvents_details-ftp_v1.0_d2008_c20250401.csv
2025-04-17 19:57:35,346 - __main__ - INFO - Processing file 14/29: StormEvents_details-ftp_v1.0_d2009_c20250401.csv
2025-04-17 19:57:35,965 - __main__ - INFO -   Read 57398 rows from StormEvents_details-ftp_v1.0_d2009_c20250401.csv
2025-04-17 19:57:36,002 - __main__ - INFO - Processing file 15/29: StormEvents_details-ftp_v1.0_d2010_c20250401.csv
2025-04-17 19:57:36,692 - __main__ - INFO -   Read 62807 rows from StormEvents_details-ftp_v1.0_d2010_c20250401.csv
2025-04-17 19:57:36,733 - __main__ - INFO - Processing file 16/29: StormEvents_details-ftp_v1.0_d2011_c20250401.csv
2025-04-17 19:57:37,633 - __main__ - INFO -   Read 79091 rows from StormEvents_details-ftp_v1.0_d2011_c20250401.csv
2025-04-17 19:57:37,683 - __main__ - INFO - Processing file 17/29: StormEvents_details-ftp_v1.0_d2012_c20250401.csv
2025-04-17 19:57:38,375 - __main__ - INFO -   Read 64503 rows from StormEvents_details-ftp_v1.0_d2012_c20250401.csv
2025-04-17 19:57:38,415 - __main__ - INFO - Processing file 18/29: StormEvents_details-ftp_v1.0_d2013_c20250401.csv
2025-04-17 19:57:39,193 - __main__ - INFO -   Read 59986 rows from StormEvents_details-ftp_v1.0_d2013_c20250401.csv
2025-04-17 19:57:39,235 - __main__ - INFO - Processing file 19/29: StormEvents_details-ftp_v1.0_d2014_c20250401.csv
2025-04-17 19:57:39,888 - __main__ - INFO -   Read 59475 rows from StormEvents_details-ftp_v1.0_d2014_c20250401.csv
2025-04-17 19:57:39,932 - __main__ - INFO - Processing file 20/29: StormEvents_details-ftp_v1.0_d2015_c20250401.csv
2025-04-17 19:57:40,577 - __main__ - INFO -   Read 57907 rows from StormEvents_details-ftp_v1.0_d2015_c20250401.csv
2025-04-17 19:57:40,611 - __main__ - INFO - Processing file 21/29: StormEvents_details-ftp_v1.0_d2016_c20250401.csv
2025-04-17 19:57:41,204 - __main__ - INFO -   Read 56005 rows from StormEvents_details-ftp_v1.0_d2016_c20250401.csv
2025-04-17 19:57:41,236 - __main__ - INFO - Processing file 22/29: StormEvents_details-ftp_v1.0_d2017_c20250401.csv
2025-04-17 19:57:41,805 - __main__ - INFO -   Read 57029 rows from StormEvents_details-ftp_v1.0_d2017_c20250401.csv
2025-04-17 19:57:41,841 - __main__ - INFO - Processing file 23/29: StormEvents_details-ftp_v1.0_d2018_c20250401.csv
2025-04-17 19:57:42,464 - __main__ - INFO -   Read 62697 rows from StormEvents_details-ftp_v1.0_d2018_c20250401.csv
2025-04-17 19:57:42,502 - __main__ - INFO - Processing file 24/29: StormEvents_details-ftp_v1.0_d2019_c20250401.csv
2025-04-17 19:57:43,293 - __main__ - INFO -   Read 67861 rows from StormEvents_details-ftp_v1.0_d2019_c20250401.csv
2025-04-17 19:57:43,336 - __main__ - INFO - Processing file 25/29: StormEvents_details-ftp_v1.0_d2020_c20240620.csv
2025-04-17 19:57:44,054 - __main__ - INFO -   Read 61279 rows from StormEvents_details-ftp_v1.0_d2020_c20240620.csv
2025-04-17 19:57:44,096 - __main__ - INFO - Processing file 26/29: StormEvents_details-ftp_v1.0_d2021_c20250401.csv
2025-04-17 19:57:44,768 - __main__ - INFO -   Read 61389 rows from StormEvents_details-ftp_v1.0_d2021_c20250401.csv
2025-04-17 19:57:44,813 - __main__ - INFO - Processing file 27/29: StormEvents_details-ftp_v1.0_d2022_c20250401.csv
2025-04-17 19:57:45,534 - __main__ - INFO -   Read 69886 rows from StormEvents_details-ftp_v1.0_d2022_c20250401.csv
2025-04-17 19:57:45,574 - __main__ - INFO - Processing file 28/29: StormEvents_details-ftp_v1.0_d2023_c20250401.csv
2025-04-17 19:57:46,402 - __main__ - INFO -   Read 75677 rows from StormEvents_details-ftp_v1.0_d2023_c20250401.csv
2025-04-17 19:57:46,443 - __main__ - INFO - Processing file 29/29: StormEvents_details-ftp_v1.0_d2024_c20250401.csv
2025-04-17 19:57:47,285 - __main__ - INFO -   Read 70196 rows from StormEvents_details-ftp_v1.0_d2024_c20250401.csv
2025-04-17 19:57:47,328 - __main__ - INFO - Concatenating 29 DataFrames...
2025-04-17 19:57:47,350 - __main__ - INFO - Adding missing anomaly type columns...
2025-04-17 19:57:47,362 - __main__ - INFO - Filtered to dates >= 1996-01-01: 348 rows (removed 0 rows)
2025-04-17 19:57:47,362 - __main__ - INFO - Initializing NCEI client for precipitation data
2025-04-17 19:57:47,363 - __main__ - INFO - Fetching real precipitation data from NCEI API...
2025-04-17 20:10:29,085 - __main__ - INFO - Successfully retrieved precipitation data (346 months) in 761.7 seconds
2025-04-17 20:10:29,085 - __main__ - INFO - Merging precipitation data with weather events...
2025-04-17 20:10:29,092 - __main__ - INFO - After merging: 348 rows
2025-04-17 20:10:29,092 - __main__ - INFO - Missing precipitation values: 14/348 (4.0%)
2025-04-17 20:10:29,093 - __main__ - WARNING - Filling 14 missing precipitation values
2025-04-17 20:10:29,093 - __main__ - INFO - Using forward fill method first...
2025-04-17 20:10:29,094 - __main__ - INFO - Successfully integrated precipitation data
2025-04-17 20:10:29,095 - __main__ - INFO - Adding seasonal indicators...
2025-04-17 20:10:29,099 - __main__ - INFO - Calculating 12-month rolling precipitation statistics...
2025-04-17 20:10:29,104 - __main__ - INFO - New columns added with 11 NaN values in rolling mean (first 11 months)
2025-04-17 20:10:29,104 - __main__ - INFO - Z-score has 11 NaN values
2025-04-17 20:10:29,106 - __main__ - INFO - Final dataset has 348 rows and 56 columns
2025-04-17 20:10:29,106 - __main__ - INFO - Date range: 1996-01 to 2024-12
2025-04-17 20:10:29,108 - __main__ - INFO - Precipitation statistics (inches):
2025-04-17 20:10:29,108 - __main__ - INFO -   Min: 0.010
2025-04-17 20:10:29,109 - __main__ - INFO -   Max: 18.950
2025-04-17 20:10:29,109 - __main__ - INFO -   Mean: 4.229
2025-04-17 20:10:29,109 - __main__ - INFO -   Median: 3.855
2025-04-17 20:10:29,109 - __main__ - INFO - Processing complete. Log file: /Users/daiwikpal/VSCode/ReTune/Anomaly Model/logs/data_processing_20250417_195728.log
2025-04-17 20:10:29,130 - __main__ - INFO - Processed data has been saved to Anomaly Model/processed_weather_data.csv
2025-04-17 20:10:29,130 - __main__ - INFO - First few rows of the processed data:
2025-04-17 20:10:29,142 - __main__ - INFO - 
  TimeStamp  AVALANCHE  BLIZZARD  COASTAL_FLOOD  COLD/WIND_CHILL  DEBRIS_FLOW  DENSE_FOG  DENSE_SMOKE  DROUGHT  DUST_DEVIL  DUST_STORM  EXCESSIVE_HEAT  ASTRONOMICAL_LOW_TIDE  EXTREME_COLD/WIND_CHILL  FLASH_FLOOD  FLOOD  FREEZING_FOG  FROST/FREEZE  FUNNEL_CLOUD  HAIL  HEAT  HEAVY_RAIN  HEAVY_SNOW  HIGH_SURF  HIGH_WIND  HURRICANE_(TYPHOON)  ICE_STORM  LAKE-EFFECT_SNOW  LAKESHORE_FLOOD  LIGHTNING  MARINE_HAIL  MARINE_HIGH_WIND  MARINE_STRONG_WIND  MARINE_THUNDERSTORM_WIND  RIP_CURRENT  SEICHE  SLEET  SNEAKERWAVE  STORM_SURGE/TIDE  STRONG_WIND  THUNDERSTORM_WIND  TORNADO  TROPICAL_DEPRESSION  TROPICAL_STORM  TSUNAMI  VOLCANIC_ASH  WATERSPOUT  WILDFIRE  WINTER_STORM  WINTER_WEATHER  PRECIPITATION  precip_12m_mean  precip_12m_std  precip_12m_z  season_sin    season_cos
0   1996-01        0.0      82.0           16.0             43.0          0.0        0.0            0      0.0         0.0           0             0.0                    0.0                      0.0          121    229           0.0           0.0             0     1     4           0         207        0.0        191                  0.0        5.0               0.0              0.0          0            0               0.0                   0                         0          0.0     0.0    0.0            0               0.0            0                 31        0                  0.0             0.0      0.0             0         0.0       0.0            42               0           5.64              NaN             NaN           NaN    0.500000  8.660254e-01
1   1996-02        0.0       0.0            0.0             34.0          0.0        3.0            0      0.0         0.0           0             0.0                    0.0                      0.0           22      0           0.0           0.0             0     1     0           0         127        0.0         78                  0.0        0.0               0.0              0.0          1            0               0.0                   0                         0          0.0     0.0    0.0            0               0.0            0                  3        0                  0.0             0.0      0.0             0         0.0       0.0            13               0           5.64              NaN             NaN           NaN    0.866025  5.000000e-01
2   1996-03        0.0       0.0           10.0             13.0          0.0        0.0            0      0.0         0.0           0             0.0                    0.0                      0.0            6      1           0.0           0.0             0     0     0           0         126        0.0         87                  0.0        4.0               0.0              0.0          3            0               0.0                   0                         0          0.0     0.0    0.0            0               0.0            0                 21        0                  0.0             0.0      0.0             0         0.0       0.0            61               3           3.81              NaN             NaN           NaN    1.000000  6.123234e-17
3   1996-04        0.0       0.0            0.0              0.0          0.0        0.0            0      0.0         0.0           0             0.0                    0.0                      0.0           44     28           0.0           0.0             0    14     0           3          27        0.0          5                  0.0        0.0               0.0              0.0          0            0               0.0                   0                         0          0.0     0.0    0.0            0               0.0            0                133        1                  0.0             0.0      0.0             0         0.0       0.0             0              25           6.33              NaN             NaN           NaN    0.866025 -5.000000e-01
4   1996-05        0.0       0.0            0.0             16.0          0.0        0.0            0      0.0         0.0           0             0.0                    0.0                      0.0           26     26           0.0           0.0             2    23    30           1          19        0.0          0                  0.0        0.0               0.0              0.0          6            0               0.0                   0                         0          0.0     0.0    0.0            0               0.0            0                137        2                  0.0             0.0      0.0             0         0.0       0.0             0              21           2.64              NaN             NaN           NaN    0.500000 -8.660254e-01
2025-04-17 20:10:29,142 - __main__ - INFO - ================================================================================
2025-04-17 20:10:29,143 - __main__ - INFO - Script execution complete
2025-04-17 20:10:29,143 - __main__ - INFO - ================================================================================
