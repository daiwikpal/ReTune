2025-04-17 19:26:17,286 - __main__ - INFO - Logging configured. Log file: /Users/daiwikpal/VSCode/ReTune/Anomaly Model/logs/data_processing_20250417_192617.log
2025-04-17 19:26:17,286 - __main__ - INFO - Starting weather data processing
2025-04-17 19:26:17,286 - __main__ - INFO - Parameters: include_precipitation=True, use_synthetic_if_api_fails=True
2025-04-17 19:26:17,286 - __main__ - INFO - Found 29 CSV files in Historical Data/*.csv
2025-04-17 19:26:17,286 - __main__ - INFO - Processing file 1/29: StormEvents_details-ftp_v1.0_d1996_c20250401.csv
2025-04-17 19:26:17,645 - __main__ - INFO -   Read 48534 rows from StormEvents_details-ftp_v1.0_d1996_c20250401.csv
2025-04-17 19:26:17,692 - __main__ - INFO - Processing file 2/29: StormEvents_details-ftp_v1.0_d1997_c20250401.csv
2025-04-17 19:26:18,065 - __main__ - INFO -   Read 41991 rows from StormEvents_details-ftp_v1.0_d1997_c20250401.csv
2025-04-17 19:26:18,091 - __main__ - INFO - Processing file 3/29: StormEvents_details-ftp_v1.0_d1998_c20250401.csv
2025-04-17 19:26:18,552 - __main__ - INFO -   Read 50973 rows from StormEvents_details-ftp_v1.0_d1998_c20250401.csv
2025-04-17 19:26:18,583 - __main__ - INFO - Processing file 4/29: StormEvents_details-ftp_v1.0_d1999_c20250401.csv
2025-04-17 19:26:19,390 - __main__ - INFO -   Read 46383 rows from StormEvents_details-ftp_v1.0_d1999_c20250401.csv
2025-04-17 19:26:19,427 - __main__ - INFO - Processing file 5/29: StormEvents_details-ftp_v1.0_d2000_c20250401.csv
2025-04-17 19:26:19,861 - __main__ - INFO -   Read 52007 rows from StormEvents_details-ftp_v1.0_d2000_c20250401.csv
2025-04-17 19:26:19,959 - __main__ - INFO - Processing file 6/29: StormEvents_details-ftp_v1.0_d2001_c20250401.csv
2025-04-17 19:26:20,436 - __main__ - INFO -   Read 48875 rows from StormEvents_details-ftp_v1.0_d2001_c20250401.csv
2025-04-17 19:26:20,466 - __main__ - INFO - Processing file 7/29: StormEvents_details-ftp_v1.0_d2002_c20250401.csv
2025-04-17 19:26:21,639 - __main__ - INFO -   Read 50936 rows from StormEvents_details-ftp_v1.0_d2002_c20250401.csv
2025-04-17 19:26:21,680 - __main__ - INFO - Processing file 8/29: StormEvents_details-ftp_v1.0_d2003_c20250401.csv
2025-04-17 19:26:22,072 - __main__ - INFO -   Read 52956 rows from StormEvents_details-ftp_v1.0_d2003_c20250401.csv
2025-04-17 19:26:22,106 - __main__ - INFO - Processing file 9/29: StormEvents_details-ftp_v1.0_d2004_c20250401.csv
2025-04-17 19:26:22,523 - __main__ - INFO -   Read 52409 rows from StormEvents_details-ftp_v1.0_d2004_c20250401.csv
2025-04-17 19:26:22,561 - __main__ - INFO - Processing file 10/29: StormEvents_details-ftp_v1.0_d2005_c20250401.csv
2025-04-17 19:26:22,989 - __main__ - INFO -   Read 53976 rows from StormEvents_details-ftp_v1.0_d2005_c20250401.csv
2025-04-17 19:26:23,025 - __main__ - INFO - Processing file 11/29: StormEvents_details-ftp_v1.0_d2006_c20250401.csv
2025-04-17 19:26:23,643 - __main__ - INFO -   Read 56400 rows from StormEvents_details-ftp_v1.0_d2006_c20250401.csv
2025-04-17 19:26:23,680 - __main__ - INFO - Processing file 12/29: StormEvents_details-ftp_v1.0_d2007_c20250401.csv
2025-04-17 19:26:24,278 - __main__ - INFO -   Read 59011 rows from StormEvents_details-ftp_v1.0_d2007_c20250401.csv
2025-04-17 19:26:24,320 - __main__ - INFO - Processing file 13/29: StormEvents_details-ftp_v1.0_d2008_c20250401.csv
2025-04-17 19:26:25,014 - __main__ - INFO -   Read 71190 rows from StormEvents_details-ftp_v1.0_d2008_c20250401.csv
2025-04-17 19:26:25,058 - __main__ - INFO - Processing file 14/29: StormEvents_details-ftp_v1.0_d2009_c20250401.csv
2025-04-17 19:26:25,651 - __main__ - INFO -   Read 57398 rows from StormEvents_details-ftp_v1.0_d2009_c20250401.csv
2025-04-17 19:26:25,685 - __main__ - INFO - Processing file 15/29: StormEvents_details-ftp_v1.0_d2010_c20250401.csv
2025-04-17 19:26:26,363 - __main__ - INFO -   Read 62807 rows from StormEvents_details-ftp_v1.0_d2010_c20250401.csv
2025-04-17 19:26:26,404 - __main__ - INFO - Processing file 16/29: StormEvents_details-ftp_v1.0_d2011_c20250401.csv
2025-04-17 19:26:27,345 - __main__ - INFO -   Read 79091 rows from StormEvents_details-ftp_v1.0_d2011_c20250401.csv
2025-04-17 19:26:27,395 - __main__ - INFO - Processing file 17/29: StormEvents_details-ftp_v1.0_d2012_c20250401.csv
2025-04-17 19:26:28,073 - __main__ - INFO -   Read 64503 rows from StormEvents_details-ftp_v1.0_d2012_c20250401.csv
2025-04-17 19:26:28,121 - __main__ - INFO - Processing file 18/29: StormEvents_details-ftp_v1.0_d2013_c20250401.csv
2025-04-17 19:26:28,859 - __main__ - INFO -   Read 59986 rows from StormEvents_details-ftp_v1.0_d2013_c20250401.csv
2025-04-17 19:26:28,900 - __main__ - INFO - Processing file 19/29: StormEvents_details-ftp_v1.0_d2014_c20250401.csv
2025-04-17 19:26:29,548 - __main__ - INFO -   Read 59475 rows from StormEvents_details-ftp_v1.0_d2014_c20250401.csv
2025-04-17 19:26:29,592 - __main__ - INFO - Processing file 20/29: StormEvents_details-ftp_v1.0_d2015_c20250401.csv
2025-04-17 19:26:30,216 - __main__ - INFO -   Read 57907 rows from StormEvents_details-ftp_v1.0_d2015_c20250401.csv
2025-04-17 19:26:30,250 - __main__ - INFO - Processing file 21/29: StormEvents_details-ftp_v1.0_d2016_c20250401.csv
2025-04-17 19:26:30,875 - __main__ - INFO -   Read 56005 rows from StormEvents_details-ftp_v1.0_d2016_c20250401.csv
2025-04-17 19:26:30,910 - __main__ - INFO - Processing file 22/29: StormEvents_details-ftp_v1.0_d2017_c20250401.csv
2025-04-17 19:26:31,497 - __main__ - INFO -   Read 57029 rows from StormEvents_details-ftp_v1.0_d2017_c20250401.csv
2025-04-17 19:26:31,534 - __main__ - INFO - Processing file 23/29: StormEvents_details-ftp_v1.0_d2018_c20250401.csv
2025-04-17 19:26:32,180 - __main__ - INFO -   Read 62697 rows from StormEvents_details-ftp_v1.0_d2018_c20250401.csv
2025-04-17 19:26:32,217 - __main__ - INFO - Processing file 24/29: StormEvents_details-ftp_v1.0_d2019_c20250401.csv
2025-04-17 19:26:32,986 - __main__ - INFO -   Read 67861 rows from StormEvents_details-ftp_v1.0_d2019_c20250401.csv
2025-04-17 19:26:33,030 - __main__ - INFO - Processing file 25/29: StormEvents_details-ftp_v1.0_d2020_c20240620.csv
2025-04-17 19:26:33,706 - __main__ - INFO -   Read 61279 rows from StormEvents_details-ftp_v1.0_d2020_c20240620.csv
2025-04-17 19:26:33,750 - __main__ - INFO - Processing file 26/29: StormEvents_details-ftp_v1.0_d2021_c20250401.csv
2025-04-17 19:26:34,427 - __main__ - INFO -   Read 61389 rows from StormEvents_details-ftp_v1.0_d2021_c20250401.csv
2025-04-17 19:26:34,473 - __main__ - INFO - Processing file 27/29: StormEvents_details-ftp_v1.0_d2022_c20250401.csv
2025-04-17 19:26:35,206 - __main__ - INFO -   Read 69886 rows from StormEvents_details-ftp_v1.0_d2022_c20250401.csv
2025-04-17 19:26:35,246 - __main__ - INFO - Processing file 28/29: StormEvents_details-ftp_v1.0_d2023_c20250401.csv
2025-04-17 19:26:36,066 - __main__ - INFO -   Read 75677 rows from StormEvents_details-ftp_v1.0_d2023_c20250401.csv
2025-04-17 19:26:36,109 - __main__ - INFO - Processing file 29/29: StormEvents_details-ftp_v1.0_d2024_c20250401.csv
2025-04-17 19:26:36,967 - __main__ - INFO -   Read 70196 rows from StormEvents_details-ftp_v1.0_d2024_c20250401.csv
2025-04-17 19:26:37,012 - __main__ - INFO - Concatenating 29 DataFrames...
2025-04-17 19:26:37,039 - __main__ - INFO - Adding missing anomaly type columns...
2025-04-17 19:26:37,056 - __main__ - INFO - Filtered to dates >= 1996-01-01: 348 rows (removed 0 rows)
2025-04-17 19:26:37,057 - __main__ - INFO - Initializing NCEI client for precipitation data
2025-04-17 19:26:37,058 - __main__ - INFO - Fetching real precipitation data from NCEI API...
2025-04-17 19:36:34,844 - __main__ - INFO - Successfully retrieved precipitation data (349 months) in 597.8 seconds
2025-04-17 19:36:34,845 - __main__ - INFO - Merging precipitation data with weather events...
2025-04-17 19:36:34,851 - __main__ - INFO - After merging: 348 rows
2025-04-17 19:36:34,852 - __main__ - INFO - Missing precipitation values: 12/348 (3.4%)
2025-04-17 19:36:34,852 - __main__ - WARNING - Filling 12 missing precipitation values
2025-04-17 19:36:34,852 - __main__ - INFO - Using forward fill method first...
2025-04-17 19:36:34,853 - __main__ - INFO - Successfully integrated precipitation data
2025-04-17 19:36:34,853 - __main__ - INFO - Final dataset has 348 rows and 51 columns
2025-04-17 19:36:34,854 - __main__ - INFO - Date range: 1996-01 to 2024-12
2025-04-17 19:36:34,857 - __main__ - INFO - Precipitation statistics (inches):
2025-04-17 19:36:34,857 - __main__ - INFO -   Min: 0.001
2025-04-17 19:36:34,857 - __main__ - INFO -   Max: 1.895
2025-04-17 19:36:34,857 - __main__ - INFO -   Mean: 0.428
2025-04-17 19:36:34,857 - __main__ - INFO -   Median: 0.392
2025-04-17 19:36:34,857 - __main__ - INFO - Processing complete. Log file: /Users/daiwikpal/VSCode/ReTune/Anomaly Model/logs/data_processing_20250417_192617.log
2025-04-17 19:36:34,879 - __main__ - INFO - Processed data has been saved to processed_weather_data.csv
2025-04-17 19:36:34,879 - __main__ - INFO - First few rows of the processed data:
2025-04-17 19:36:34,892 - __main__ - INFO - 
  TimeStamp  AVALANCHE  BLIZZARD  COASTAL_FLOOD  COLD/WIND_CHILL  DEBRIS_FLOW  DENSE_FOG  DENSE_SMOKE  DROUGHT  DUST_DEVIL  DUST_STORM  EXCESSIVE_HEAT  ASTRONOMICAL_LOW_TIDE  EXTREME_COLD/WIND_CHILL  FLASH_FLOOD  FLOOD  FREEZING_FOG  FROST/FREEZE  FUNNEL_CLOUD  HAIL  HEAT  HEAVY_RAIN  HEAVY_SNOW  HIGH_SURF  HIGH_WIND  HURRICANE_(TYPHOON)  ICE_STORM  LAKE-EFFECT_SNOW  LAKESHORE_FLOOD  LIGHTNING  MARINE_HAIL  MARINE_HIGH_WIND  MARINE_STRONG_WIND  MARINE_THUNDERSTORM_WIND  RIP_CURRENT  SEICHE  SLEET  SNEAKERWAVE  STORM_SURGE/TIDE  STRONG_WIND  THUNDERSTORM_WIND  TORNADO  TROPICAL_DEPRESSION  TROPICAL_STORM  TSUNAMI  VOLCANIC_ASH  WATERSPOUT  WILDFIRE  WINTER_STORM  WINTER_WEATHER  PRECIPITATION
0   1996-01        0.0      82.0           16.0             43.0          0.0        0.0            0      0.0         0.0           0             0.0                    0.0                      0.0          121    229           0.0           0.0             0     1     4           0         207        0.0        191                  0.0        5.0               0.0              0.0          0            0               0.0                   0                         0          0.0     0.0    0.0            0               0.0            0                 31        0                  0.0             0.0      0.0             0         0.0       0.0            42               0          0.564
1   1996-02        0.0       0.0            0.0             34.0          0.0        3.0            0      0.0         0.0           0             0.0                    0.0                      0.0           22      0           0.0           0.0             0     1     0           0         127        0.0         78                  0.0        0.0               0.0              0.0          1            0               0.0                   0                         0          0.0     0.0    0.0            0               0.0            0                  3        0                  0.0             0.0      0.0             0         0.0       0.0            13               0          0.259
2   1996-03        0.0       0.0           10.0             13.0          0.0        0.0            0      0.0         0.0           0             0.0                    0.0                      0.0            6      1           0.0           0.0             0     0     0           0         126        0.0         87                  0.0        4.0               0.0              0.0          3            0               0.0                   0                         0          0.0     0.0    0.0            0               0.0            0                 21        0                  0.0             0.0      0.0             0         0.0       0.0            61               3          0.381
3   1996-04        0.0       0.0            0.0              0.0          0.0        0.0            0      0.0         0.0           0             0.0                    0.0                      0.0           44     28           0.0           0.0             0    14     0           3          27        0.0          5                  0.0        0.0               0.0              0.0          0            0               0.0                   0                         0          0.0     0.0    0.0            0               0.0            0                133        1                  0.0             0.0      0.0             0         0.0       0.0             0              25          0.633
4   1996-05        0.0       0.0            0.0             16.0          0.0        0.0            0      0.0         0.0           0             0.0                    0.0                      0.0           26     26           0.0           0.0             2    23    30           1          19        0.0          0                  0.0        0.0               0.0              0.0          6            0               0.0                   0                         0          0.0     0.0    0.0            0               0.0            0                137        2                  0.0             0.0      0.0             0         0.0       0.0             0              21          0.264
2025-04-17 19:36:34,893 - __main__ - INFO - ================================================================================
2025-04-17 19:36:34,893 - __main__ - INFO - Script execution complete
2025-04-17 19:36:34,893 - __main__ - INFO - ================================================================================
